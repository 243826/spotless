apply plugin: 'org.gradle.test-retry'

def special = [
	'Npm',
	'Black',
	'Clang'
]

boolean isCiServer = true
tasks.named('test') {
	// See com.diffplug.spotless.tag package for available JUnit 5 @Tag annotations
	useJUnitPlatform {
		excludeTags special as String[]
	}
	if (isCiServer) {
		retry {
			maxRetries = 2
			maxFailures = 2
		}
	}
}

special.forEach { tag ->
	tasks.register("${tag}Test", Test) {
		useJUnitPlatform { includeTags tag }
	}
}
